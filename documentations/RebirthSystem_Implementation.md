# Generated by SuperbulletAI (and how it planned to make it, feel free to delete this)

---

# Rebirth System Implementation

## Overview

A complete rebirth system has been implemented that allows players to reset their levels at a maximum level threshold and gain rebirth counters as a prestige mechanic.

## Key Features

### 1. Max Level Concept

- Each level type now has a `MaxLevel` defined in `LevelingConfig.lua`
- When a player reaches max level, they become eligible for rebirth
- Current max levels:
  - **Levels**: 100
  - **Ranks**: 50
  - **Stages**: 75
  - **Tiers**: 60

### 2. Rebirth Eligibility System

- Players can only rebirth when they reach the max level for that type
- Server-side validation ensures security (no client-side exploits)
- Real-time eligibility checking on both client and server

### 3. Dedicated Rebirth UI (Cleaner Design)

- **Access Method:**
  - Each level type frame has its own "⭐ REBIRTH" button
  - Click a level type's rebirth button to open that rebirth type's UI
- **UI Features:**
  - **Focused Display**: Shows only ONE rebirth type at a time
  - **Grouped Level Types**: Shows all level types that share the same rebirth type
  - **Example**: Clicking "Levels" rebirth button shows "Rebirths" UI with levels, stages, and tiers
  - **Total Count**: Displays combined rebirth count across all level types in that family
  - **Individual Buttons**: Each level type has its own rebirth button within the UI
  - Real-time status updates (Ready/Not Ready)
  - Visual feedback with color-coded buttons:
    - **Green**: Ready to rebirth
    - **Gray**: Not yet eligible
- **Why This Design is Better:**
  - Cleaner, more focused interface
  - Groups related level types by rebirth family
  - Easier to understand rebirth relationships
  - Less UI clutter

### 4. Rebirth Process

When a player performs a rebirth:

1. **Validation**: Server checks if player is at max level
2. **Increment**: Rebirth counter increases by 1
3. **Reset**: Level resets to 1, EXP resets to 0
4. **Signal**: Server fires `Rebirthed` signal to all clients
5. **UI Update**: UI automatically updates to reflect changes

## Files Modified/Created

### Modified Files:

1. **`LevelingConfig.lua`**

   - Added `MaxLevel` to each level type
   - Enabled rebirths (`enabled = true`)

2. **`LevelService/Components/Set().lua`**

   - Added `CanRebirth()` method
   - Added `PerformRebirth()` method

3. **`LevelService/init.lua`**

   - Added `Rebirthed` client signal
   - Exposed `CanRebirth()` and `PerformRebirth()` methods
   - Added client remote methods

4. **`LevelController/Components/Get().lua`**

   - Added `CanRebirth()` method
   - Added `GetMaxLevel()` method
   - Added `GetRebirthEligibility()` method

5. **`LevelController/init.lua`**

   - Added `Rebirthed` signal
   - Exposed rebirth methods
   - Added keyboard shortcut (R key)
   - Added rebirth signal connection

6. **`UI.lua`**

   - Added "⭐ REBIRTH" button to main level UI

7. **`LevelSystemTesters.server.lua`**
   - Added "Perform Rebirth" tester button (Cyan)
   - Added "Set to Max Level" tester button (Magenta)
   - Updated instruction sign

### Created Files:

1. **`RebirthUI.lua`** (New Component)
   - Complete rebirth UI implementation
   - Button creation for each level type
   - Real-time status updates
   - Rebirth action handling

## Server Methods

### LevelService:CanRebirth(player, levelType)

- Checks if a player is eligible for rebirth
- Returns: `boolean`
- Validates:
  - Rebirths are enabled globally
  - Level type has rebirth enabled (`RebirthType` is not nil)
  - Player is at max level

### LevelService:PerformRebirth(player, levelType)

- Performs the rebirth action
- Returns: `success (boolean), message (string)`
- Actions:
  - Validates eligibility
  - Increments rebirth count
  - Resets level to 1
  - Fires `Rebirthed` signal

## Client Methods

### LevelController:CanRebirth(levelType)

- Client-side eligibility check
- Returns: `boolean`

### LevelController:GetRebirthEligibility(levelType)

- Detailed eligibility information
- Returns:

```lua
{
    eligible = boolean,
    currentLevel = number,
    maxLevel = number,
    rebirthCount = number,
    rebirthName = string,
    reason = string,
}
```

### LevelController:PerformRebirth(levelType)

- Requests rebirth from server
- Returns: Promise with `success, message`

### LevelController:ShowRebirthUI(rebirthType)

- Shows rebirth UI for a specific rebirth type
- Called when clicking a level type's rebirth button
- Parameters:
  - `rebirthType`: The rebirth family to display (e.g., "rebirth" or "ascension")

## Testing

### Tester Buttons (Row 3):

1. **Gold Button**: +1 Rebirth (levels) - Manually add rebirth count
2. **Purple Button**: +1 Ascension (ranks) - Manually add ascension count
3. **Orange-Red Button**: Reset Level (levels) - Reset without rebirthing
4. **Pink Button**: Set Rebirth to 5 (levels) - Testing purposes
5. **Cyan Button**: Perform Rebirth (levels) - Uses new PerformRebirth method ⭐
6. **Magenta Button**: Set to Max Level - Automatically levels to max for testing ⭐

### Testing Workflow:

1. Use **Magenta button** to quickly reach max level
2. Press **R** key or click **⭐ REBIRTH** button to open UI
3. Click **⭐ REBIRTH NOW!** button for your level type
4. Verify level resets to 1 and rebirth count increases

## User Experience

### Player Journey:

1. **Level Up**: Player gains EXP and levels normally
2. **Max Level**: Player reaches level 100 (for "levels" type)
3. **Notification**: "⭐ REBIRTH" button appears on the level type frame
4. **Decision**: Player clicks the "⭐ REBIRTH" button on their level type
5. **View Rebirth UI**: Opens the rebirth family UI (e.g., "Rebirths" for levels/stages/tiers)
6. **Rebirth**: Player clicks the rebirth button for their specific level type
7. **Prestige**: Level resets to 1, rebirth counter increases
8. **Repeat**: Player continues with increased rebirth count

### Rebirth Family Example:

- **Rebirths** family includes:
  - Levels (has `RebirthType = "rebirth"`)
  - Stages (has `RebirthType = "rebirth"`)
  - Tiers (has `RebirthType = "rebirth"`)
- **Ascensions** family includes:
  - Ranks (has `RebirthType = "ascension"`)

When you click "⭐ REBIRTH" on Levels, you see all three (Levels, Stages, Tiers) in one UI!
When you click "⭐ REBIRTH" on Ranks, you see only Ranks (it's alone in Ascensions family).

### Visual Feedback:

- **Not Ready**: Gray button, shows required level
- **Ready**: Green glowing button, success message
- **After Rebirth**: Counter updates, level resets, UI refreshes

## Configuration

### Adjusting Max Levels:

Edit `LevelingConfig.lua`:

```lua
Types = {
    levels = {
        Name = "Level",
        ExpName = "EXP",
        MaxLevel = 100,  -- Change this value
        Scaling = { Formula = "Linear" }
    },
}
```

### Enabling/Disabling Rebirths:

```lua
-- Globally disable rebirths for all level types
Rebirths = {
    enabled = true,  -- Set to false to disable globally
    Types = { ... },
}

-- Disable rebirth for a specific level type
Types = {
    levels = {
        Name = "Level",
        RebirthType = nil,  -- Set to nil to disable rebirth for this type only
        -- Or set to a rebirth type name to enable:
        -- RebirthType = "rebirth",
    }
}
```

## Security

### Server-Side Validation:

- All rebirth checks happen on the server
- Client cannot force rebirth without meeting requirements
- Anti-exploit measures:
  - Level validation
  - Max level verification
  - Rebirth mapping validation

### Rate Limiting:

- Tester buttons have 2-second cooldown
- Rebirth action is atomic (all-or-nothing)

## Future Enhancements

### Possible Additions:

1. **Rebirth Bonuses**: Stat multipliers based on rebirth count
2. **Rebirth Rewards**: Unlock new content after rebirths
3. **Rebirth Animations**: Visual effects when rebirthing
4. **Rebirth History**: Track rebirth timestamps
5. **Multiple Rebirth Tiers**: Different max levels for different rebirth counts

## Troubleshooting

### Common Issues:

**Q: Rebirth button stays gray even at max level?**

- Verify `MaxLevel` is set in config
- Check if rebirths are enabled globally (`Rebirths.enabled = true`)
- Ensure level type has `RebirthType` set (not nil)
- Verify the `RebirthType` exists in `Rebirths.Types`

**Q: Rebirth UI not opening?**

- Check console for errors
- Verify RebirthUI component is loaded
- Try using R key instead of button

**Q: Rebirth count not increasing?**

- Check server console for error messages
- Verify ProfileService is working
- Test with tester buttons first

## Summary

The rebirth system provides:
✅ Max level thresholds for each level type
✅ Dedicated rebirth UI with real-time updates
✅ Server-authoritative rebirth validation
✅ Easy-to-use interface (R key + button)
✅ Visual feedback for eligibility
✅ Testing tools for development
✅ Extensible architecture for future features

The system is production-ready and fully integrated with the existing level system!
